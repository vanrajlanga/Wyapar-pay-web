(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[220],{3077:function(e,t,s){Promise.resolve().then(s.bind(s,1235))},9376:function(e,t,s){"use strict";var r=s(5475);s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},1235:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var r=s(7437),a=s(2265),n=s(9376),i=s(9765),o=s(9775),c=s(3976),l=s(4034),u=s(7903),d=s(2744);function h(){let e=(0,n.useRouter)(),{isAuthenticated:t}=(0,i.a)(),[s,h]=(0,a.useState)([]),[m,x]=(0,a.useState)([]),[f,g]=(0,a.useState)(!0),[p,y]=(0,a.useState)("all"),[b,v]=(0,a.useState)("all"),[T,N]=(0,a.useState)(""),[j,E]=(0,a.useState)(!1),[k,w]=(0,a.useState)({from:"",to:""}),A=async()=>{g(!0);try{let e=await l.O.getTransactions({});h(e),x(e)}catch(e){u.k.error("Failed to load transactions",e)}finally{g(!1)}},S=(0,a.useCallback)(()=>{let e=[...s];"all"!==p&&(e=e.filter(e=>e.status===p)),"all"!==b&&(e=e.filter(e=>e.type===b)),T&&(e=e.filter(e=>e.description.toLowerCase().includes(T.toLowerCase())||e.id.toLowerCase().includes(T.toLowerCase()))),k.from&&(e=e.filter(e=>new Date(e.createdAt)>=new Date(k.from))),k.to&&(e=e.filter(e=>new Date(e.createdAt)<=new Date(k.to))),x(e)},[s,p,b,T,k]);return(0,a.useEffect)(()=>{if(!t){e.push(c.Z6.LOGIN);return}A()},[t,e]),(0,a.useEffect)(()=>{S()},[s,p,b,T,k,S]),(0,r.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,r.jsx)("header",{className:"bg-white border-b border-border sticky top-0 z-10",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[(0,r.jsx)("button",{onClick:()=>e.back(),className:"text-text-secondary hover:text-primary transition-colors",children:"← Back"}),(0,r.jsx)("h1",{className:"text-2xl font-display font-bold text-text-primary",children:"Transaction History"}),(0,r.jsx)("button",{onClick:()=>E(!j),className:"p-2 hover:bg-background rounded-lg transition-colors",children:(0,r.jsx)(d.VK0,{size:24,className:"text-text-secondary"})})]})}),(0,r.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,r.jsx)(o.Zb,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-text-secondary mb-1",children:"Total Transactions"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-text-primary",children:m.length})]}),(0,r.jsx)("div",{className:"p-3 bg-primary/10 rounded-lg",children:(0,r.jsx)(d.gSd,{size:24,className:"text-primary"})})]})}),(0,r.jsx)(o.Zb,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-text-secondary mb-1",children:"Total Amount"}),(0,r.jsxs)("p",{className:"text-2xl font-bold text-text-primary",children:["₹",m.filter(e=>"success"===e.status).reduce((e,t)=>e+t.amount,0).toFixed(2)]})]}),(0,r.jsx)("div",{className:"p-3 bg-accent-success/10 rounded-lg",children:(0,r.jsx)(d.gSd,{size:24,className:"text-accent-success"})})]})}),(0,r.jsx)(o.Zb,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-text-secondary mb-1",children:"Success Rate"}),(0,r.jsxs)("p",{className:"text-2xl font-bold text-text-primary",children:[0===m.length?0:Math.round(m.filter(e=>"success"===e.status).length/m.length*100),"%"]})]}),(0,r.jsx)("div",{className:"p-3 bg-secondary/10 rounded-lg",children:(0,r.jsx)(d.ZuN,{size:24,className:"text-secondary"})})]})})]}),(0,r.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"flex-1 relative",children:[(0,r.jsx)(d.vU7,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary",size:20}),(0,r.jsx)(o.II,{type:"text",placeholder:"Search by description or transaction ID...",value:T,onChange:e=>N(e),className:"pl-10"})]}),(0,r.jsxs)(o.zx,{variant:"outline",onClick:()=>{let e=new Blob([["Date,Type,Description,Amount,Status",...m.map(e=>[new Date(e.createdAt).toLocaleDateString(),e.type,e.description,e.amount,e.status].join(","))].join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="transactions-".concat(new Date().toISOString().split("T")[0],".csv"),s.click()},disabled:0===m.length,children:[(0,r.jsx)(d.uKn,{className:"mr-2"}),"Export"]})]}),j&&(0,r.jsxs)(o.Zb,{className:"p-6 mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-text-primary",children:"Filters"}),(0,r.jsx)("button",{onClick:()=>E(!1),className:"text-text-secondary hover:text-text-primary",children:(0,r.jsx)(d.FU5,{size:24})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Status"}),(0,r.jsxs)("select",{value:p,onChange:e=>y(e.target.value),className:"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary bg-white text-text-primary",children:[(0,r.jsx)("option",{value:"all",children:"All Statuses"}),(0,r.jsx)("option",{value:"success",children:"Success"}),(0,r.jsx)("option",{value:"pending",children:"Pending"}),(0,r.jsx)("option",{value:"failed",children:"Failed"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Type"}),(0,r.jsxs)("select",{value:b,onChange:e=>v(e.target.value),className:"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary bg-white text-text-primary",children:[(0,r.jsx)("option",{value:"all",children:"All Types"}),(0,r.jsx)("option",{value:"mobile_recharge",children:"Mobile Recharge"}),(0,r.jsx)("option",{value:"dth_recharge",children:"DTH Recharge"}),(0,r.jsx)("option",{value:"electricity_bill",children:"Electricity Bill"}),(0,r.jsx)("option",{value:"water_bill",children:"Water Bill"}),(0,r.jsx)("option",{value:"gas_bill",children:"Gas Bill"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"From Date"}),(0,r.jsx)("input",{type:"date",value:k.from,onChange:e=>w({...k,from:e.target.value}),className:"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary bg-white text-text-primary"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"To Date"}),(0,r.jsx)("input",{type:"date",value:k.to,onChange:e=>w({...k,to:e.target.value}),className:"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary bg-white text-text-primary"})]})]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(o.zx,{variant:"outline",onClick:()=>{y("all"),v("all"),N(""),w({from:"",to:""})},children:"Clear Filters"})})]}),(0,r.jsx)("div",{className:"flex gap-2 mb-6 overflow-x-auto pb-2",children:["all","success","pending","failed"].map(e=>(0,r.jsx)("button",{onClick:()=>y(e),className:"\n                px-4 py-2 rounded-lg font-medium whitespace-nowrap transition-colors\n                ".concat(p===e?"bg-primary text-white shadow-md":"bg-white text-text-secondary hover:bg-background border border-border","\n              "),children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),f?(0,r.jsx)("div",{className:"flex justify-center py-12",children:(0,r.jsx)(o.$j,{size:"lg"})}):m.length>0?(0,r.jsx)("div",{className:"space-y-3",children:m.map(t=>(0,r.jsx)(o.Zb,{hover:!0,onClick:()=>e.push("".concat(c.Z6.TRANSACTIONS,"/").concat(t.id)),className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,r.jsx)("div",{className:"p-3 bg-primary/10 rounded-lg",children:(0,r.jsx)(d.IXo,{size:24,className:"text-primary"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"font-medium text-text-primary mb-1",children:t.description}),(0,r.jsxs)("div",{className:"flex items-center gap-3 text-sm text-text-secondary",children:[(0,r.jsx)("span",{children:t.type.replace(/_/g," ")}),(0,r.jsx)("span",{children:"•"}),(0,r.jsx)("span",{children:new Date(t.createdAt).toLocaleString()})]})]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("p",{className:"font-semibold text-text-primary text-lg mb-1",children:["₹",t.amount]}),(0,r.jsx)(o.Ct,{variant:"success"===t.status?"success":"failed"===t.status?"error":"warning",size:"sm",children:t.status})]})]})},t.id))}):(0,r.jsxs)(o.Zb,{className:"p-12 text-center",children:[(0,r.jsx)("p",{className:"text-text-secondary mb-4",children:"No transactions found"}),(0,r.jsx)("button",{onClick:()=>e.push(c.Z6.RECHARGE),className:"text-primary hover:text-primary-light font-medium transition-colors",children:"Make your first recharge →"})]})]})]})}},9765:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return h},a:function(){return m}});var r=s(7437),a=s(2265),n=s(3976),i=s(7571),o=s(4569);class c{async register(e){return await i.E.post(n.Pn.AUTH.REGISTER,e)}async login(e){var t,s;let r=await i.E.post(n.Pn.AUTH.LOGIN,e);return(null===(t=r.tokens)||void 0===t?void 0:t.accessToken)&&(null===(s=r.tokens)||void 0===s?void 0:s.refreshToken)&&(o.t.saveTokens(r.tokens.accessToken,r.tokens.refreshToken),o.t.saveUser(r.user)),r}async requestOtp(e){return i.E.post(n.Pn.AUTH.REQUEST_OTP,e)}async loginWithOtp(e){var t,s;let r=await i.E.post(n.Pn.AUTH.OTP_LOGIN,e);return(null===(t=r.tokens)||void 0===t?void 0:t.accessToken)&&(null===(s=r.tokens)||void 0===s?void 0:s.refreshToken)&&(o.t.saveTokens(r.tokens.accessToken,r.tokens.refreshToken),o.t.saveUser(r.user)),r}async verifyEmail(e){return i.E.post(n.Pn.AUTH.VERIFY_EMAIL,{token:e})}async resendVerification(e){return i.E.post(n.Pn.AUTH.RESEND_VERIFICATION,{userId:e})}async logout(){try{await i.E.post(n.Pn.AUTH.LOGOUT,{})}finally{o.t.clearAuth()}}async refreshToken(){var e,t;let s=o.t.getRefreshToken();if(!s)throw Error("No refresh token available");let r=await i.E.post(n.Pn.AUTH.REFRESH_TOKEN,{refreshToken:s});return(null===(e=r.tokens)||void 0===e?void 0:e.accessToken)&&(null===(t=r.tokens)||void 0===t?void 0:t.refreshToken)&&o.t.saveTokens(r.tokens.accessToken,r.tokens.refreshToken),r}isAuthenticated(){return!!o.t.getAccessToken()}getCurrentUser(){return o.t.getUser()}}let l=new c;var u=s(7903);let d=(0,a.createContext)(void 0);function h(e){let{children:t}=e,[s,n]=(0,a.useState)(null),[i,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(()=>{try{let e=o.t.getUser(),t=o.t.getAccessToken();e&&t&&n(e)}catch(e){u.k.error("Error initializing auth",e)}finally{c(!1)}})()},[]);let h=async e=>{try{let t=await l.login(e);n(t.user),u.k.info("Login successful")}catch(e){throw u.k.error("Login failed",e),e}},m=async e=>{try{await l.register(e),u.k.info("Registration successful")}catch(e){throw u.k.error("Registration failed",e),e}},x=async e=>{try{await l.requestOtp(e),u.k.info("OTP requested successfully")}catch(e){throw u.k.error("OTP request failed",e),e}},f=async e=>{try{let t=await l.loginWithOtp(e);n(t.user),u.k.info("OTP login successful")}catch(e){throw u.k.error("OTP login failed",e),e}},g=async e=>{try{await l.verifyEmail(e),u.k.info("Email verified successfully")}catch(e){throw u.k.error("Email verification failed",e),e}},p=async e=>{try{await l.resendVerification(e),u.k.info("Verification email resent")}catch(e){throw u.k.error("Resend verification failed",e),e}},y=async()=>{try{await l.logout(),n(null),u.k.info("Logout successful")}catch(e){u.k.error("Logout failed",e),n(null)}},b=async()=>{try{let e=o.t.getUser();n(e)}catch(e){u.k.error("Error refreshing user",e)}};return(0,r.jsx)(d.Provider,{value:{user:s,isAuthenticated:!!s,isLoading:i,login:h,register:m,requestOtp:x,loginWithOtp:f,verifyEmail:g,resendVerification:p,logout:y,refreshUser:b},children:t})}function m(){let e=(0,a.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7571:function(e,t,s){"use strict";s.d(t,{E:function(){return c}});var r=s(3976),a=s(7903),n=s(4569);class i extends Error{constructor(e,t,s){super(e),this.statusCode=t,this.response=s,this.name="ApiError"}}class o{async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=new AbortController,o=setTimeout(()=>s.abort(),this.timeout),c="".concat(this.baseUrl).concat(e),l=n.t.getAccessToken();a.k.logApiCall(t.method||"GET",e,t.body?JSON.parse(t.body):void 0);try{let n=await fetch(c,{...t,signal:s.signal,headers:{"Content-Type":"application/json",...l?{Authorization:"Bearer ".concat(l)}:{},...t.headers}});clearTimeout(o);let u=await n.json();if(a.k.logApiResponse(e,n.status,u),!n.ok)throw new i(u.message||r.RZ.SOMETHING_WENT_WRONG,n.status,u);return u}catch(t){if(clearTimeout(o),t instanceof i)throw t;if(t instanceof Error&&"AbortError"===t.name)throw a.k.error("API request timeout",t,{endpoint:e}),new i("Request timeout. Please try again.");throw a.k.error("API network error",t,{endpoint:e}),new i(r.RZ.NETWORK_ERROR)}}async get(e,t){return this.request(e,{method:"GET",headers:t?{Authorization:"Bearer ".concat(t)}:{}})}async post(e,t,s){return this.request(e,{method:"POST",body:JSON.stringify(t),headers:s?{Authorization:"Bearer ".concat(s)}:{}})}async put(e,t,s){return this.request(e,{method:"PUT",body:JSON.stringify(t),headers:s?{Authorization:"Bearer ".concat(s)}:{}})}async delete(e,t){return this.request(e,{method:"DELETE",headers:t?{Authorization:"Bearer ".concat(t)}:{}})}async patch(e,t,s){return this.request(e,{method:"PATCH",body:JSON.stringify(t),headers:s?{Authorization:"Bearer ".concat(s)}:{}})}constructor(){this.baseUrl=r.Hz.BASE_URL,this.timeout=r.Hz.TIMEOUT}}let c=new o},4034:function(e,t,s){"use strict";s.d(t,{O:function(){return i}});var r=s(3976),a=s(7571);class n{async getBalance(){return a.E.get(r.Pn.WALLET.BALANCE)}async getTransactions(e){let t=e?new URLSearchParams(e).toString():"";return a.E.get("".concat(r.Pn.TRANSACTIONS.GET_ALL).concat(t?"?".concat(t):""))}async getTransactionById(e){return a.E.get(r.Pn.TRANSACTIONS.GET_BY_ID(e))}async getTransactionSummary(){return a.E.get(r.Pn.TRANSACTIONS.GET_SUMMARY)}async getRecentTransactions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return a.E.get("".concat(r.Pn.TRANSACTIONS.GET_RECENT,"?limit=").concat(e))}async getTransactionsByCategory(e){return a.E.get(r.Pn.TRANSACTIONS.GET_BY_CATEGORY(e))}async searchTransactions(e){return a.E.post(r.Pn.TRANSACTIONS.SEARCH,{query:e})}async getTransactionStats(){return a.E.get(r.Pn.TRANSACTIONS.GET_STATS)}}let i=new n},7903:function(e,t,s){"use strict";s.d(t,{k:function(){return a}});class r{log(e,t,s){if(!this.isDevelopment&&"debug"===e)return;let r=new Date().toISOString(),a="[".concat(r,"] [").concat(e.toUpperCase(),"]");switch(e){case"info":console.log(a,t,s||"");break;case"warn":console.warn(a,t,s||"");break;case"error":console.error(a,t,s||"");break;case"debug":console.debug(a,t,s||"")}}info(e,t){this.log("info",e,t)}warn(e,t){this.log("warn",e,t)}error(e,t,s){this.log("error",e,{error:t,...s})}debug(e,t){this.log("debug",e,t)}logApiCall(e,t,s){this.debug("API ".concat(e," ").concat(t),s)}logApiResponse(e,t,s){this.debug("API Response ".concat(e),{status:t,data:s})}constructor(){this.isDevelopment=!1}}let a=new r},4569:function(e,t,s){"use strict";s.d(t,{t:function(){return n}});var r=s(3976);class a{setItem(e,t){if(this.isClient)try{let s=JSON.stringify(t);localStorage.setItem(e,s)}catch(e){}}getItem(e){if(!this.isClient)return null;try{let t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(e){return null}}removeItem(e){if(this.isClient)try{localStorage.removeItem(e)}catch(e){}}clear(){if(this.isClient)try{localStorage.clear()}catch(e){}}saveTokens(e,t){this.setItem(r.I.ACCESS_TOKEN,e),this.setItem(r.I.REFRESH_TOKEN,t)}getAccessToken(){return this.getItem(r.I.ACCESS_TOKEN)}getRefreshToken(){return this.getItem(r.I.REFRESH_TOKEN)}clearTokens(){this.removeItem(r.I.ACCESS_TOKEN),this.removeItem(r.I.REFRESH_TOKEN)}saveUser(e){this.setItem(r.I.USER_DATA,e)}getUser(){return this.getItem(r.I.USER_DATA)}clearUser(){this.removeItem(r.I.USER_DATA)}clearAuth(){this.clearTokens(),this.clearUser()}constructor(){this.isClient=!0}}let n=new a}},function(e){e.O(0,[51,38,659,971,117,744],function(){return e(e.s=3077)}),_N_E=e.O()}]);